<div class="main-wrapper">
  <div class="left-menu">
    <h3>UPDATE</h3>
    <form #form="ngForm" (ngSubmit)="updateClient()">
      <mat-form-field>
        <mat-label>Name</mat-label>
        <input
          type="text"
          name="name"
          [(ngModel)]="client.name"
          matInput
          required
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>Surname</mat-label>
        <input
          type="text"
          name="surname"
          [(ngModel)]="client.surname"
          matInput
          required
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>Phone</mat-label>
        <input
          type="tel"
          name="phone"
          [(ngModel)]="client.phone"
          matInput
          minlength="6"
          maxlength="15"
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>Email</mat-label>
        <input
          type="email"
          name="email"
          [(ngModel)]="client.email"
          matInput
          email
        >
      </mat-form-field>

      <button mat-flat-button *ngIf="canUpdateClient" [disabled]="!form.valid">Update</button>
    </form>
  </div>
  <div class="client-tasks" *ngIf="canSeeTasks">
    <h3>TASKS</h3>
    <mat-expansion-panel #formpanel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          CREATE
        </mat-panel-title>
      </mat-expansion-panel-header>
      <form #taskForm="ngForm" (ngSubmit)="createTask(taskForm)">
        <mat-form-field>
          <mat-label>Message</mat-label>
          <input
            type="text"
            name="message"
            ngModel
            matInput
            required
          >
        </mat-form-field>
        <mat-form-field>
          <mat-label>Date</mat-label>
          <input
            type="text"
            matInput
            ngModel
            name="date"
            [matDatepicker]="taskPickerDate"
            placeholder="Choose a date"
          >
          <mat-datepicker-toggle matSuffix [for]="taskPickerDate"></mat-datepicker-toggle>
          <mat-datepicker #taskPickerDate disabled="false"></mat-datepicker>
        </mat-form-field>
        <button mat-flat-button [disabled]="!taskForm.valid">Create</button>
      </form>
    </mat-expansion-panel>
    <app-tasks-table
      *ngIf="client.id"
      [byClientId]="client.id"
      #tasksTable
    ></app-tasks-table>
  </div>
  <div class="client-comments" *ngIf="canSeeComments">
    <h3>COMMENTS</h3>
    <mat-expansion-panel #formpanelComments>
      <mat-expansion-panel-header>
        <mat-panel-title>
          CREATE
        </mat-panel-title>
      </mat-expansion-panel-header>
      <form #commentForm="ngForm" (ngSubmit)="createComment(commentForm)">
        <mat-form-field>
          <mat-label>Text</mat-label>
          <input
            type="text"
            name="text"
            ngModel
            matInput
            required
          >
        </mat-form-field>
        <mat-form-field>
          <mat-label>Date</mat-label>
          <input
            type="text"
            matInput
            ngModel
            name="date"
            [matDatepicker]="commentPickerDate"
            placeholder="Choose a date"
          >
          <mat-datepicker-toggle matSuffix [for]="commentPickerDate"></mat-datepicker-toggle>
          <mat-datepicker #commentPickerDate disabled="false"></mat-datepicker>
        </mat-form-field>
        <button mat-flat-button [disabled]="!commentForm.valid">Create</button>
      </form>
    </mat-expansion-panel>
    <app-comments-table
      *ngIf="client.id"
      #commentTable
      [byClientId]="client.id"
    ></app-comments-table>
  </div>
  <div class="client-applications" *ngIf="canSeeApplications">
    <h3>APPLICATIONS</h3>
    <mat-expansion-panel #formpanelApplications *ngIf="canCreateApplication">
      <mat-expansion-panel-header>
        <mat-panel-title>
          CREATE
        </mat-panel-title>
      </mat-expansion-panel-header>
      <form #formApplication="ngForm" (ngSubmit)="createApplication(formApplication)">
        <mat-form-field>
          <mat-label>Date</mat-label>
          <input
            type="text"
            matInput
            ngModel
            name="date"
            [matDatepicker]="applicationPickerDate"
            placeholder="Choose a date"
          >
          <mat-datepicker-toggle matSuffix [for]="applicationPickerDate"></mat-datepicker-toggle>
          <mat-datepicker #applicationPickerDate disabled="false"></mat-datepicker>
        </mat-form-field>
        <mat-form-field>
          <mat-label>City</mat-label>
          <mat-select ngModel name="cityId" required>
            <mat-option *ngFor="let city of cities" [value]="city.id">
              {{city.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field>
          <mat-label>Course</mat-label>
          <mat-select ngModel name="courseId" required>
            <mat-option *ngFor="let course of courses" [value]="course.id">
              {{course.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field>
          <mat-label>Source</mat-label>
          <mat-select ngModel name="sources" multiple>
            <mat-option *ngFor="let source of sources" [value]="source.id">
              {{source.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field>
          <mat-label>Discount</mat-label>
          <input
            type="number"
            name="discount"
            ngModel
            matInput
            (input)="validateDiscount($event)"
          >
        </mat-form-field>
        <mat-checkbox ngModel name="wantPractice">Want practice</mat-checkbox>
        <button mat-flat-button [disabled]="!formApplication.valid">Create</button>
      </form>
    </mat-expansion-panel>
    <app-applications-table
      *ngIf="client.id"
      [byClientId]="client.id"
      [canDeleteApplicationInput]="canDeleteApplication"
      #applicationTable
    ></app-applications-table>
  </div>
</div>
